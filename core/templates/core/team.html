{% extends 'base.html' %}
{% block title %}{{ team_page.hero_title|default:"Our Team" }} • Magma7Fitness{% endblock %}
{% block content %}

<!-- Hero Section -->
<section style="width: 100vw; margin-left: calc(-50vw + 50%); min-height: 70vh; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #1a1d21 0%, var(--primary-dark) 100%); text-align: center; position: relative; overflow: hidden; padding: 120px 20px 80px;">
  {% if team_page.hero_image_url %}
  <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; opacity: 0.2; background: url('{{ team_page.hero_image_url }}') center/cover;"></div>
  {% endif %}

  <div style="max-width: 1200px; margin: 0 auto; position: relative; z-index: 2;">
    <h1 style="font-size: 4rem; font-weight: 900; color: white; margin: 0 auto 1.5rem auto; text-transform: uppercase;">
      {{ team_page.hero_title|default:"Meet Our Expert Team" }}
    </h1>

    {% if team_page.hero_subtitle %}
    <p style="color: rgba(255, 255, 255, 0.95); font-size: 1.3rem; max-width: 800px; margin: 0 auto;">
      {{ team_page.hero_subtitle }}
    </p>
    {% endif %}
  </div>
</section>

<!-- Introduction -->
{% if team_page.intro_content %}
<section class="section" style="padding: 80px 0; background: var(--light-bg);">
  <div class="container" style="text-align: center; max-width: 900px;">
    <h2 style="font-size: 2.8rem; font-weight: 800; color: var(--text-primary); margin-bottom: 25px;">
      {{ team_page.intro_title }}
    </h2>
    <p style="color: var(--text-secondary); font-size: 1.2rem; line-height: 1.8;">{{ team_page.intro_content }}</p>
  </div>
</section>
{% endif %}

<!-- Roles Overview -->
<section class="section" style="padding: 60px 0; background: var(--section-bg);">
  <div class="container">
    <h2 style="text-align:center; font-size: 2.2rem; font-weight:900; margin-bottom: 28px;">What Our Team Does</h2>
    <style>
      .role-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap:18px; }
      .role-card { background:#fff; border:1px solid #edf2f7; border-radius:14px; padding:16px; box-shadow:0 6px 24px rgba(2,6,23,.06); transition: transform .25s ease, box-shadow .25s ease; }
      .role-card:hover { transform: translateY(-4px); box-shadow:0 12px 30px rgba(2,6,23,.10); }
      .role-head { display:flex; align-items:center; gap:12px; margin-bottom:10px; }
      .role-head i { color: var(--primary-green); }
      .role-card p { margin:0; color:#4a5568; font-size:.95rem; line-height:1.6; }
    </style>
    <div class="role-grid">
      <article class="role-card">
        <div class="role-head"><i class="material-icons">fitness_center</i><strong>Fitness Instructors</strong></div>
        <p>Design personalized programs, coach form, and motivate you through every session.</p>
      </article>
      <article class="role-card">
        <div class="role-head"><i class="material-icons">restaurant</i><strong>Nutritionists</strong></div>
        <p>Provide personalized nutrition advice to fuel performance and recovery.</p>
      </article>
      <article class="role-card">
        <div class="role-head"><i class="material-icons">support_agent</i><strong>Customer Service</strong></div>
        <p>Friendly, knowledgeable help for memberships, bookings, and questions.</p>
      </article>
      <article class="role-card">
        <div class="role-head"><i class="material-icons">cleaning_services</i><strong>Cleaning Team</strong></div>
        <p>Maintain spotless, hygienic spaces throughout the day for safe training.</p>
      </article>
      <article class="role-card">
        <div class="role-head"><i class="material-icons">campaign</i><strong>Marketing & Sales</strong></div>
        <p>Grow our community, share success stories, and help new members join.</p>
      </article>
      <article class="role-card">
        <div class="role-head"><i class="material-icons">manage_accounts</i><strong>Management</strong></div>
        <p>Keep operations smooth and member experience exceptional, every day.</p>
      </article>
    </div>
  </div>
  
</section>

<!-- Featured Team Members (New Card Style) -->
{% if featured_members %}
<section class="section" style="padding: 80px 0; background: var(--section-bg);">
  <div class="container">
    <h2 style="text-align: center; font-size: 3rem; font-weight: 800; margin-bottom: 60px;">Featured Trainers</h2>

    <div class="row" style="display: flex; flex-wrap: wrap; gap: 30px; justify-content: center;">
      {% for member in featured_members %}
      <div class="col s12 m6 l3" style="display: flex;">
        <div class="team-card hoverable" style="width:100%; border-radius:12px; overflow:hidden; cursor:pointer; background:#fff; box-shadow: var(--shadow-md);"
             data-name="{{ member.name|escapejs }}"
             data-role="{{ member.role|escapejs }}"
             data-category="{{ member.role_category }}"
             data-image="{{ member.image_url|escapejs }}"
             data-bio="{{ member.bio|escapejs }}"
             data-years="{{ member.experience_years }}"
             data-specialties="{{ member.specialties|default:''|escapejs }}"
             data-certifications="{{ member.certifications|default:''|escapejs }}"
             data-email="{{ member.email|default:''|escapejs }}"
             data-phone="{{ member.phone|default:''|escapejs }}"
             data-instagram="{{ member.instagram|default:''|escapejs }}"
             data-linkedin="{{ member.linkedin|default:''|escapejs }}">
          <div style="position:relative; height: 360px;">
            <img src="{{ member.image_url }}" alt="{{ member.name }}" style="width:100%; height:100%; object-fit:cover; display:block;">
            <div style="position:absolute; inset:0; background: linear-gradient(180deg, rgba(0,0,0,0) 35%, rgba(0,0,0,0.75) 100%);"></div>
            <div style="position:absolute; left:0; right:0; bottom:0; padding:18px 16px;">
              <div style="color:#fff; font-weight:800; font-size:1.1rem; letter-spacing:.2px;">{{ member.name }}</div>
              <div style="color:var(--accent-gold); font-size:.9rem; font-weight:700; opacity:.95;">{{ member.role }}</div>
            </div>
            <div style="position:absolute; top:12px; left:12px; background: rgba(255,255,255,.95); color:#111; font-size:.72rem; font-weight:800; padding:6px 10px; border-radius:999px; letter-spacing:.5px;">FEATURED</div>
          </div>
          <div style="padding: 12px 14px; display:flex; align-items:center; justify-content:space-between;">
            <span style="color: var(--text-secondary); font-size:.9rem;">Tap to view profile</span>
            <i class="material-icons" style="color: var(--primary-green);">open_in_new</i>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
 </section>
{% endif %}

<!-- All Team Members (New Card Style) -->
{% if team_members %}
<section class="section" style="padding: 80px 0; background: var(--light-bg);">
  <div class="container">
    <h2 style="text-align: center; font-size: 3rem; font-weight: 800; margin-bottom: 10px;">Our Complete Team</h2>
    <div style="text-align:center; margin-bottom: 30px;">
      <style>
        .team-filters { display:inline-flex; gap:8px; flex-wrap:wrap; }
        .team-chip { border:1px solid #e2e8f0; background:#fff; color:#475569; padding:6px 12px; border-radius:999px; font-weight:700; cursor:pointer; font-size:.85rem; }
        .team-chip.active { background: var(--primary-green); color:#fff; border-color: var(--primary-green); }
      </style>
      <div class="team-filters" id="teamFilters">
        <button class="team-chip active" data-filter="all">All</button>
        <button class="team-chip" data-filter="trainer">Trainers</button>
        <button class="team-chip" data-filter="instructor">Instructors</button>
        <button class="team-chip" data-filter="nutritionist">Nutritionists</button>
        <button class="team-chip" data-filter="support">Support</button>
        <button class="team-chip" data-filter="specialist">Specialists</button>
        <button class="team-chip" data-filter="manager">Management</button>
      </div>
    </div>

    <div id="teamGrid" class="row" style="display:flex; flex-wrap:wrap; gap:30px; justify-content:center;">
      {% for member in team_members %}
      <div class="col s12 m6 l4" style="display:flex;">
        <div class="team-card hoverable" style="width:100%; border-radius:12px; overflow:hidden; cursor:pointer; background:#fff; box-shadow: var(--shadow-md);"
             data-name="{{ member.name|escapejs }}"
             data-role="{{ member.role|escapejs }}"
             data-category="{{ member.role_category }}"
             data-image="{{ member.image_url|escapejs }}"
             data-bio="{{ member.bio|escapejs }}"
             data-years="{{ member.experience_years }}"
             data-specialties="{{ member.specialties|default:''|escapejs }}"
             data-certifications="{{ member.certifications|default:''|escapejs }}"
             data-email="{{ member.email|default:''|escapejs }}"
             data-phone="{{ member.phone|default:''|escapejs }}"
             data-instagram="{{ member.instagram|default:''|escapejs }}"
             data-linkedin="{{ member.linkedin|default:''|escapejs }}">
          <div style="position:relative; height: 320px;">
            <img src="{{ member.image_url }}" alt="{{ member.name }}" style="width:100%; height:100%; object-fit:cover; display:block;">
            <div style="position:absolute; inset:0; background: linear-gradient(180deg, rgba(0,0,0,0) 35%, rgba(0,0,0,0.8) 100%);"></div>
            <div style="position:absolute; left:0; right:0; bottom:0; padding:16px 14px;">
              <div style="color:#fff; font-weight:800; font-size:1.05rem; letter-spacing:.2px;">{{ member.name }}</div>
              <div style="color:var(--accent-gold); font-size:.85rem; font-weight:700; opacity:.95;">{{ member.role }}</div>
            </div>
          </div>
          <div style="padding: 10px 14px; display:flex; align-items:center; justify-content:space-between;">
            <span style="color: var(--text-secondary); font-size:.9rem;">Tap to view profile</span>
            <i class="material-icons" style="color: var(--primary-green);">open_in_new</i>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>
{% endif %}

<!-- CTA -->
{% if team_page %}
<section style="margin: 80px 0;">
  <div class="container">
    <div style="background: linear-gradient(135deg, var(--primary-green) 0%, var(--primary-dark) 100%); border-radius: 20px; padding: 80px 40px; text-align: center;">
      <h2 style="font-size: 3rem; font-weight: 900; color: white; margin-bottom: 20px;">{{ team_page.cta_title }}</h2>
      <p style="color: rgba(255, 255, 255, 0.95); font-size: 1.3rem; max-width: 600px; margin: 0 auto 40px auto;">{{ team_page.cta_description }}</p>
      <a href="{{ team_page.cta_button_url }}" class="btn btn-large" style="background: white; color: var(--primary-green); padding: 20px 50px; font-size: 1.2rem; font-weight: 700; border-radius: 50px;">
        {{ team_page.cta_button_text }}
      </a>
    </div>
  </div>
</section>
{% endif %}

<!-- Team Modal -->
<div id="teamModal" style="display:none; position:fixed; inset:0; z-index:9999; background: rgba(0,0,0,0.85); align-items:center; justify-content:center; padding:20px;">
  <div style="width:100%; max-width: 1000px; background:#111; border-radius:12px; overflow:hidden; box-shadow:0 20px 60px rgba(0,0,0,.5);">
    <div style="position:relative; background:#000;">
      <img id="teamModalImg" src="" alt="" style="width:100%; max-height: 60vh; object-fit:cover; display:block;">
      <button id="teamModalClose" aria-label="Close" style="position:absolute; top:10px; right:10px; width:42px; height:42px; border:none; border-radius:50%; background: rgba(0,0,0,.6); color:#fff; cursor:pointer; font-size:20px;">×</button>
    </div>
    <div style="padding: 20px 22px; color:#fff;">
      <h3 id="teamModalName" style="margin:0 0 6px 0; font-weight:900;"></h3>
      <div id="teamModalRole" style="color: var(--accent-gold); font-weight:700; margin-bottom:12px;"></div>
      <div id="teamModalYears" style="color:#9ae6b4; font-weight:700; margin-bottom: 12px;"></div>
      <p id="teamModalBio" style="margin: 10px 0 16px 0; line-height:1.7; opacity:.95;"></p>
      <div id="teamModalSpecs" style="display:flex; flex-wrap:wrap; gap:12px; margin-bottom: 12px;"></div>
      <div id="teamModalCerts" style="display:flex; flex-wrap:wrap; gap:12px; margin-bottom: 12px;"></div>
      <div id="teamModalContacts" style="display:flex; flex-wrap:wrap; gap:14px; opacity:.95;"></div>
    </div>
  </div>
  <script>
    (function(){
      const modal = document.getElementById('teamModal');
      const img = document.getElementById('teamModalImg');
      const nameEl = document.getElementById('teamModalName');
      const roleEl = document.getElementById('teamModalRole');
      const yearsEl = document.getElementById('teamModalYears');
      const bioEl = document.getElementById('teamModalBio');
      const specsEl = document.getElementById('teamModalSpecs');
      const certsEl = document.getElementById('teamModalCerts');
      const contactsEl = document.getElementById('teamModalContacts');
      const closeBtn = document.getElementById('teamModalClose');

      function chip(text){
        const span = document.createElement('span');
        span.textContent = text;
        span.style.cssText = 'background:#1a1f24;color:#ddd;border:1px solid #2a3138;border-radius:20px;padding:6px 12px;font-size:.85rem;';
        return span;
      }

      function link(label, url){
        const a = document.createElement('a');
        a.textContent = label; a.href = url; a.target = '_blank';
        a.style.cssText = 'color:#9ae6b4; font-weight:700; text-decoration:none;';
        return a;
      }

      function open(card){
        const d = card.dataset;
        img.src = d.image || '';
        nameEl.textContent = d.name || '';
        roleEl.textContent = d.role || '';
        yearsEl.textContent = d.years && d.years !== '0' ? (d.years + '+ Years Experience') : '';
        bioEl.textContent = d.bio || '';
        specsEl.innerHTML = '';
        certsEl.innerHTML = '';
        contactsEl.innerHTML = '';
        if (d.specialties) d.specialties.split(',').map(s=>s.trim()).filter(Boolean).forEach(s=>specsEl.appendChild(chip(s)));
        if (d.certifications) d.certifications.split(',').map(s=>s.trim()).filter(Boolean).forEach(s=>certsEl.appendChild(chip(s)));
        if (d.email) { contactsEl.appendChild(link('Email', 'mailto:' + d.email)); }
        if (d.phone) { contactsEl.appendChild(link('Call', 'tel:' + d.phone)); }
        if (d.instagram) { contactsEl.appendChild(link('Instagram', d.instagram)); }
        if (d.linkedin) { contactsEl.appendChild(link('LinkedIn', d.linkedin)); }
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
      }

      function close(){ modal.style.display = 'none'; document.body.style.overflow = ''; img.src=''; }

      document.addEventListener('click', function(e){
        const card = e.target.closest('.team-card');
        if (card) { open(card); }
        if (e.target === modal) { close(); }
      });
      closeBtn.addEventListener('click', close);
      document.addEventListener('keydown', function(e){ if (e.key === 'Escape') close(); });

      // Filters
      const filters = document.getElementById('teamFilters');
      const grid = document.getElementById('teamGrid');
      function applyFilter(val){
        const cards = grid ? grid.querySelectorAll('.team-card') : [];
        cards.forEach(c => {
          const cat = (c.dataset.category || '').toLowerCase();
          c.parentElement.parentElement.style.display = (val === 'all' || cat === val) ? '' : 'none';
        });
      }
      if (filters) {
        filters.addEventListener('click', function(e){
          const btn = e.target.closest('.team-chip');
          if (!btn) return;
          e.preventDefault();
          filters.querySelectorAll('.team-chip').forEach(b=>b.classList.remove('active'));
          btn.classList.add('active');
          applyFilter(btn.dataset.filter || 'all');
        });
      }
    })();
  </script>
</div>
{% endblock %}
