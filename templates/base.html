{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}{{ site_settings.brand_name|default:"Magma7Fitness" }} - Professional Gym Management{% endblock %}</title>

  <!-- Favicon -->
  {% if site_settings.get_favicon_url %}
  <link rel="icon" type="image/x-icon" href="{{ site_settings.get_favicon_url }}">
  {% endif %}

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
  <link href="{% static 'css/styles.css' %}" rel="stylesheet">

  <!-- Meta -->
  <meta name="description" content="Professional gym membership management system - Join {{ site_settings.brand_name|default:'Magma7Fitness' }} today">
  <meta name="theme-color" content="#ff5a5a">
 </head>
<body>
  <nav class="nav-elevated" role="navigation">
    <div class="nav-wrapper container">
      <a id="logo-container" href="/" class="brand-logo" style="height: 100px; padding: 0; display: flex; align-items: center; margin-top: -15px;">
        {% if site_settings.get_logo_url %}
          <img src="{{ site_settings.get_logo_url }}" alt="{{ site_settings.brand_name|default:'Magma7Fitness' }}" style="height: 100px; max-width: 500px; object-fit: contain;">
        {% else %}
          {{ site_settings.brand_name|default:"Magma7Fitness" }}
        {% endif %}
      </a>
      <ul class="right hide-on-med-and-down">
        <li><a class="nav-link" href="/about/">About</a></li>
        <li><a class="nav-link" href="/facilities/">Facilities</a></li>
        <li><a class="nav-link" href="/team/">Team</a></li>
        <li><a class="nav-link" href="/cms/testimonials/">Testimonials</a></li>
        <li><a class="btn btn-ghost" href="/memberships/plans/">Membership</a></li>
        {% if user.is_authenticated %}
          <li><a class="nav-link" href="/memberships/dashboard/">Dashboard</a></li>
          <li>
            <a href="/notifications/" class="notif-bell">
              <i class="material-icons">notifications</i>
              {% if unread_notifications_count %}
                <span class="notif-dot"></span>
              {% endif %}
            </a>
          </li>
          <li><a class="btn btn-outline" href="/accounts/logout/">Logout</a></li>
        {% else %}
          <li><a class="nav-link" href="/accounts/login/">Login</a></li>
          <li><a href="/accounts/signup/" class="btn btn-primary" style="margin-left:8px">Join</a></li>
        {% endif %}
      </ul>

      <ul id="nav-mobile" class="sidenav">
        <li><a href="/about/">About</a></li>
        <li><a href="/facilities/">Facilities</a></li>
        <li><a href="/team/">Team</a></li>
        <li><a href="/cms/testimonials/">Testimonials</a></li>
        <li><a href="/memberships/plans/">Membership Plans</a></li>
        {% if user.is_authenticated %}
          <li><a href="/memberships/dashboard/">Dashboard</a></li>
          <li>
            <a href="/notifications/">Notifications
              {% if unread_notifications_count %}
                <span class="badge">{{ unread_notifications_count }}</span>
              {% endif %}
            </a>
          </li>
          <li><a href="/accounts/logout/">Logout</a></li>
        {% else %}
          <li><a href="/accounts/login/">Login</a></li>
          <li><a href="/accounts/signup/">Join Now</a></li>
        {% endif %}
      </ul>
      <a href="#" data-target="nav-mobile" class="sidenav-trigger"><i class="material-icons">menu</i></a>
    </div>
  </nav>

  {% if messages %}
    <style>
      /* Fallback toast styles for dev environments without Materialize JS */
      .toast-fallback-container { position: fixed; top: 20px; right: 20px; z-index: 9999; display: flex; flex-direction: column; gap: 10px; }
      .toast-fallback { color: #fff; padding: 12px 16px; border-radius: 6px; box-shadow: 0 6px 16px rgba(0,0,0,0.2); font-weight: 600; letter-spacing: .2px; }
      .toast-fallback.success { background: #00695c; }
      .toast-fallback.error { background: #b71c1c; }
      .toast-fallback.warning { background: #ff8f00; color: #000; }
      .toast-fallback.info { background: #0d47a1; }
      .toast-fallback.default { background: #424242; }
    </style>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        function tagKey(tags) {
          try {
            if (!tags) return 'default';
            if (tags.indexOf('success') !== -1) return 'success';
            if (tags.indexOf('error') !== -1) return 'error';
            if (tags.indexOf('warning') !== -1) return 'warning';
            if (tags.indexOf('info') !== -1) return 'info';
          } catch (e) {}
          return 'default';
        }

        var hasMaterialize = (typeof window.M !== 'undefined' && typeof window.M.toast === 'function');
        {% for message in messages %}
          (function(msg, tags){
            if (hasMaterialize) {
              var clsMap = { success: 'teal darken-1', error: 'red darken-2', warning: 'amber darken-2 black-text', info: 'blue darken-1', default: 'grey darken-3' };
              var key = tagKey(tags);
              M.toast({ html: msg, classes: 'rounded ' + (clsMap[key] || clsMap.default), displayLength: 4000 });
            } else {
              var key = tagKey(tags);
              var box = document.createElement('div');
              box.className = 'toast-fallback ' + key;
              box.textContent = msg;
              var host = document.getElementById('toast-fallback-host');
              if (!host) {
                host = document.createElement('div');
                host.id = 'toast-fallback-host';
                host.className = 'toast-fallback-container';
                document.body.appendChild(host);
              }
              host.appendChild(box);
              setTimeout(function(){ if (box && box.parentNode) { box.parentNode.removeChild(box); } }, 4000);
            }
          })('{{ message|escapejs }}', '{{ message.tags|escapejs }}');
        {% endfor %}
      });
    </script>
  {% endif %}

  <main>
    {% block content %}{% endblock %}
  </main>

  <footer class="page-footer">
    <div class="container">
      <div class="row" style="padding: 40px 0 20px 0;">
        <div class="col s12 m6 l4">
          <h5 style="color: white; font-weight: 800; margin-bottom: 20px;">
            Magma7 Fitness Center
          </h5>
          <p class="footer-light" style="line-height: 1.6; margin-bottom: 20px;">
            Transform your body and mind with professional training, state-of-the-art equipment, and a supportive community.
          </p>
          <p class="footer-light">
            <i class="material-icons tiny" style="color: var(--accent-gold);">location_on</i>
            No. 30 Zakaria Maimalari Street<br>
            <span style="margin-left: 20px;">Nasfat Layout, Kaduna</span>
          </p>
          <p class="footer-light">
            <i class="material-icons tiny" style="color: var(--accent-gold);">phone</i>
            +234 (0) 123 456 789
          </p>
        </div>

        <div class="col s12 m6 l2">
          <h6 style="color: var(--text-primary); font-weight: 600; margin-bottom: 20px;">Quick Links</h6>
          <ul style="list-style: none; padding: 0;">
            <li style="margin-bottom: 8px;"><a class="footer-link" href="/memberships/plans/">Membership Plans</a></li>
            <li style="margin-bottom: 8px;"><a class="footer-link" href="/about/">About Us</a></li>
            <li style="margin-bottom: 8px;"><a class="footer-link" href="/facilities/">Facilities</a></li>
            <li style="margin-bottom: 8px;"><a class="footer-link" href="/team/">Our Team</a></li>
          </ul>
        </div>

        <div class="col s12 m6 l2">
          <h6 style="color: var(--text-primary); font-weight: 600; margin-bottom: 20px;">Support</h6>
          <ul style="list-style: none; padding: 0;">
            <li style="margin-bottom: 8px;"><a class="footer-link" href="/cms/testimonials/">Testimonials</a></li>
            <li style="margin-bottom: 8px;"><a class="footer-link" href="/contact/">Contact Support</a></li>
            <li style="margin-bottom: 8px;"><a class="footer-link" href="/faq/">FAQ</a></li>
            <li style="margin-bottom: 8px;"><a class="footer-link" href="/help/">Help Center</a></li>
          </ul>
        </div>

        <div class="col s12 m6 l4">
          <h6 style="color: var(--text-primary); font-weight: 600; margin-bottom: 20px;">Operating Hours</h6>
          <div style="margin-bottom: 20px;">
            <p class="footer-light" style="margin-bottom: 5px;"><strong>Monday - Friday:</strong> 5:00 AM - 11:00 PM</p>
            <p class="footer-light" style="margin-bottom: 5px;"><strong>Saturday:</strong> 6:00 AM - 10:00 PM</p>
            <p class="footer-light" style="margin-bottom: 5px;"><strong>Sunday:</strong> 7:00 AM - 9:00 PM</p>
          </div>

          <h6 style="color: var(--text-primary); font-weight: 600; margin-bottom: 15px;">Follow Us</h6>
          <div style="display: flex; gap: 15px;">
            <a href="#" style="color: var(--text-secondary); font-size: 1.5rem; transition: color 0.3s;"
               onmouseover="this.style.color='var(--primary-red)'"
               onmouseout="this.style.color='var(--text-secondary)'">
              <i class="material-icons">facebook</i>
            </a>
            <a href="#" style="color: var(--text-secondary); font-size: 1.5rem; transition: color 0.3s;"
               onmouseover="this.style.color='var(--primary-red)'"
               onmouseout="this.style.color='var(--text-secondary)'">
              <i class="material-icons">camera_alt</i>
            </a>
            <a href="#" style="color: var(--text-secondary); font-size: 1.5rem; transition: color 0.3s;"
               onmouseover="this.style.color='var(--primary-red)'"
               onmouseout="this.style.color='var(--text-secondary)'">
              <i class="material-icons">chat</i>
            </a>
          </div>
        </div>
      </div>
    </div>

    <div class="footer-copy">
      <div class="container">
        <div class="row" style="align-items: center;">
          <div class="col s12 m6">
            <p style="margin: 0; color: var(--text-muted);">
              Â© <span id="year"></span> Magma7Fitness. All rights reserved.
            </p>
          </div>
          <div class="col s12 m6" style="text-align: right;">
            <a href="/privacy/" class="footer-link" style="margin-right: 20px;">Privacy Policy</a>
            <a href="/terms/" class="footer-link">Terms of Service</a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var elems = document.querySelectorAll('.sidenav');
      M.Sidenav.init(elems);
      document.getElementById('year').innerText = new Date().getFullYear();
    });
  </script>
  <!-- Hero Slider Script -->
  <script src="{% static 'js/hero-slider.js' %}"></script>
</body>
</html>
